---
import Layout from '../layouts/Layout.astro';

import ToggleTheme from '../components/toggle-theme';
import UpcomingRaceHero from '../components/upcoming-race-hero.astro';
import UpcomingRace from '../components/upcoming-race.astro';
import RestOfRaces from '../components/rest-of-races.astro';
import Footer from '../components/footer.astro';
import Intro from '../components/intro.astro';
import Wrapper from '../components/wrapper.astro';

import { getRaces } from '../api/get-races';

const { upcomingRace, restOfRaces } = await getRaces();
---

<Layout>
  <Wrapper>
    <Intro>
      <ToggleTheme client:only="preact" />
    </Intro>
    <UpcomingRaceHero upcomingRace={upcomingRace} />
    <UpcomingRace upcomingRace={upcomingRace} />
  </Wrapper>

  <Wrapper>
    {restOfRaces?.length > 0 && <RestOfRaces restOfRaces={restOfRaces} />}
    <Footer />
  </Wrapper>
</Layout>
